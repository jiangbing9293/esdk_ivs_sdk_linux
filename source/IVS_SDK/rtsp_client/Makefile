#############################################################################
# Makefile for building: gessctrl
#############################################################################

CC         = g++
LINK       = g++

CXX_FULL_VERSION := $(shell $(CC) --version)

ROOT_DIR  = ./

ifeq (Red Hat, $(findstring Red Hat,$(CXX_FULL_VERSION)))
  C++FLAGS  += -pipe -g -Wall -fpic -O0 -m32 -DLINUX -DOS_REDHAT_i386
else
  C++FLAGS  += -pipe -g -Wall -fpic -O0 -m32 -DLINUX  
endif

LIBS      += -shared -fPIC -m32 -lm -lpthread -Wl

TARGET_DIR = $(ROOT_DIR)lib/
TARGET     = $(TARGET_DIR)libRtsp_client32.so

INCPATH   += -I. -I../../../../platform/IVS_COMMON/CBB/release/new/header/ACE_wrappers/ -I./header/

CPPFILES  += $(wildcard $(ROOT_DIR)/source/*.cpp)
CFILES    += $(wildcard $(ROOT_DIR)*.c)
HEADFILES += $(wildcard $(ROOT_DIR)/header/*.h)


COBJS     =  $(CFILES:.c=.o)
CPPOBJS   =  $(CPPFILES:.cpp=.O)

all: $(TARGET)
$(TARGET): $(CPPOBJS) $(COBJS)
		$(LINK) $(C++FLAGS) -o $@ $(CPPOBJS) $(COBJS) $(LIBS)
        
%.o : %.c $(HEADFILES)
		$(CC) -c  $(C++FLAGS) $(INCPATH) $< -o $@

%.O : %.cpp $(HEADFILES)
		$(CC) -c  $(C++FLAGS) $(INCPATH) $< -o $@       

clean:
		rm -f $(TARGET) $(CPPOBJS) $(COBJS)
		
copy:
		cp ./lib/libRtsp_client32.so ../../../../platform/IVS_COMMON/CBB/release/new/linux/libivs_rtsp_client.so

